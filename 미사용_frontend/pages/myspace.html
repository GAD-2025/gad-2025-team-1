<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>김민지님의 My Space</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="../../frontend/style/myspace.css">
</head>
<body>
    <header class="main-header">
    <div class="header-section header-left">
       <a href="/gad-2025-team-1/frontend/pages/explore.html" class="header-logo">
            <span style="color: #FF5900;">creAItive</span>
        </a>
    </div>

  <nav class="header-section header-center">
        <ul class="header-menu">
            <li><a href="../../frontend/pages/marketplace.html">거래하기</a></li>
            <li><a href="../..//frontend/pages/archive.html" >작품보관함</a></li>
            <li><a href="../../frontend/pages/myspace.html" class="active">마이 스페이스</a></li>
            <li><a href="../../frontend/pages/setting.html">설정</a></li>
        </ul>
    </nav>

    <div class="header-section header-right">
        <a href="../../frontend/pages/login.html" class="login-button">로그인</a>
    </div>

</header>

    <main class="myspace-container">

        <section class="section-profile">
    <div class="profile-visual-area">
        <div class="neighbor-profile neighbor-1">
        <img src="../../frontend/images/friend_1.jpg" alt="이웃 프로필 1">
    </div>
    <div class="neighbor-profile neighbor-2">
        <img src="../../frontend/images/friend_2.jpg" alt="이웃 프로필 2">
    </div>
    <div class="neighbor-profile neighbor-3">
        <img src="../../frontend/images/friend_3.jpg" alt="이웃 프로필 3">
    </div>
    <div class="neighbor-profile neighbor-4">
        <img src="../../frontend/images/friend_4.jpg" alt="이웃 프로필 4">
    </div>

        <div class="profile-image-wrapper">
            <img src="../../frontend/images/White Cats.jpg" alt="프로필 사진" class="profile-main-image">

            <div class="social-orbit-container">
                <a href="https://instagram.com" target="_blank" class="social-icon social-insta" title="Instagram"><i class="fab fa-instagram"></i></a>
                <a href="https://facebook.com" target="_blank" class="social-icon social-facebook" title="Facebook"><i class="fab fa-facebook-f"></i></a>
                <a href="https://youtube.com" target="_blank" class="social-icon social-youtube" title="YouTube"><i class="fab fa-youtube"></i></a>
                <a href="mailto:user@email.com" class="social-icon social-email" title="Email"><i class="fas fa-envelope"></i></a>
            </div>
        </div>
    </div>

    <div class="profile-info">
        <h1 class="user-name">
            김민지
            <span class="badge-me">me</span>
        </h1>
        <p class="user-bio">창작을 좋아하는 열정가득 대학생입니다</p>
        <a href="../../frontend/pages/myspace_setting.html"><button class="btn-profile-manage">프로필 관리</button></a>
    </div>
</section>

        <section class="section-works">
            <p class="section-welcome-message">Welcome to my space</p>

            <div class="folder-icons-container">
                <a href="../../frontend/pages/myspace_folder.html" class="folder-item">
                    <div class="folder-icon-circle"><img src="../../frontend/images/folder_1.jpg" alt="WISH 폴더"></div>
                    <span class="folder-name">WISH</span>
                </a>
                <a href="/my-work" class="folder-item">
                    <div class="folder-icon-circle"><img src="../../frontend/images/folder_2.jpg" alt="My Work 폴더"></div>
                    <span class="folder-name">My Work</span>
                </a>
                <a href="/art-folder" class="folder-item">
                    <div class="folder-icon-circle"><img src="../../frontend/images/folder_3.jpg" alt="ART 폴더"></div>
                    <span class="folder-name">ART</span>
                </a>
            </div>

            <div class="artwork-orbit-area">
    <div class="orbit orbit-outer">
        <a href="/node/1" class="artwork-item item-1 horizontal" title="작품 1"><img src="../../frontend/images/art_5.jpg" alt="작품 1"></a>
        <a href="../../frontend/pages/myspace_node.html" class="artwork-item item-2 horizontal" title="작품 2"><img src="../../frontend/images/art_6.jpg" alt="작품 2"></a>
        <a href="/node/3" class="artwork-item item-3 horizontal" title="작품 3"><img src="../../frontend/images/art_7.jpg" alt="작품 3"></a>
        
        <a href="/node/4" class="artwork-item item-4 vertical" title="작품 4"><img src="../../frontend/images/art_1.jpg" alt="작품 4"></a>
    </div>
    <div class="orbit orbit-inner">
        <a href="/node/5" class="artwork-item item-5 vertical" title="작품 5"><img src="../../frontend/images/art_2.jpg" alt="작품 5"></a>
        <a href="/node/6" class="artwork-item item-6 vertical" title="작품 6"><img src="../../rontend/images/art_3.jpg" alt="작품 6"></a>
        <a href="/node/7" class="artwork-item item-7 vertical" title="작품 7"><img src="../../frontend/images/art_4.jpg" alt="작품 7"></a>
    </div>
    
</div>
<div>
    <br><p class="section-welcome-message">궤도를 회전하여 김민지님의 스페이스를 탐험해보세요.</p>
</div>
        </section>

    </main>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="../../backend/myspace.js"></script> </body>
    <script>
/* myspace.html 또는 explore.html의 <script> 내부 */

// 1. 서버 주소 (서버가 3000포트에서 돌고 있음)
const API_URL = 'http://localhost:3000/api/posts';

// 2. 데이터 가져오기 (fetch 함수 사용)
async function fetchPosts() {
    try {
        const response = await fetch(API_URL);
        
        // 응답 상태 확인
        if (!response.ok) {
            throw new Error('데이터를 불러오는데 실패했습니다.');
        }

        // JSON 데이터로 변환
        const data = await response.json();
        
        console.log("서버에서 가져온 데이터:", data);
        
        // 3. 화면에 그리기 (예시 함수)
        renderPosts(data); 

    } catch (error) {
        console.error("에러 발생:", error);
    }
}

// 화면에 데이터를 뿌려주는 함수 (예시)
function renderPosts(posts) {
    // 예: orbit-grid 영역에 이미지 추가하기
    // const container = document.getElementById('orbitGridArea'); 
    // container.innerHTML = '';
    
    posts.forEach(post => {
        console.log(`제목: ${post.title}, 작가: ${post.author}`);
        // 여기에 HTML 생성 코드를 넣으면 됩니다.
    });
}

// 페이지 로드 시 실행
document.addEventListener("DOMContentLoaded", fetchPosts);


    /* myspace.html 하단에 추가할 스크립트 */
    document.addEventListener("DOMContentLoaded", function() {
        // 1. 저장된 데이터 불러오기
        const savedData = localStorage.getItem('myspaceData');
        
        if (savedData) {
            const data = JSON.parse(savedData);

            // 2. 프로필 정보 업데이트
            const userNameEls = document.querySelectorAll('.user-name, .widget-user-name');
            userNameEls.forEach(el => {
                 // "me" 뱃지 유지를 위해 textNode만 교체하거나 html 재구성
                 if(el.classList.contains('user-name')) {
                     el.innerHTML = `${data.name} <span class="badge-me">me</span>`;
                 } else {
                     el.textContent = data.name;
                 }
            });

            document.querySelector('.user-bio').textContent = data.bio;
            
            const profileImgEls = document.querySelectorAll('.profile-main-image, .widget-profile-img');
            profileImgEls.forEach(img => img.src = data.img);

            // 3. 폴더 이름 업데이트 (단순 매핑)
            const folderNames = document.querySelectorAll('.folder-name');
            if (data.folders && data.folders.length > 0) {
                folderNames.forEach((el, idx) => {
                    if (data.folders[idx]) el.textContent = data.folders[idx].name;
                });
            }

            // 4. Orbit (대표 작품) 업데이트
            const orbitOuter = document.querySelector('.orbit-outer');
            const orbitInner = document.querySelector('.orbit-inner');
            
            // 기존 오비트 아이템들 초기화 (class 유지 등을 위해 내용만 비우거나 재구성)
            // 여기서는 간단하게 기존 HTML 구조를 유지하면서 이미지만 교체하는 방식을 사용하거나
            // 동적으로 생성해야 하는데, 개수가 달라질 수 있으므로 동적 생성이 좋습니다.
            
            // myspace.html 하단 스크립트 일부 수정

if (data.orbit && data.orbit.length > 0) {
    orbitOuter.innerHTML = '';
    orbitInner.innerHTML = '';

    data.orbit.forEach((imgSrc, index) => {
        const targetContainer = (index % 2 === 0) ? orbitOuter : orbitInner;
        const itemClass = (index % 2 === 0) ? 'horizontal' : 'vertical';
        
        // [수정 핵심] 이동할 경로 설정
        // index(0, 1, 2...)를 꼬리표로 붙여서 어떤 작품인지 구별합니다.
        const nodePagePath = `../../frontend/pages/myspace_node.html?id=${index}`;

        const aTag = document.createElement('a');
        aTag.href = nodePagePath; // 여기에 경로 적용
        aTag.className = `artwork-item item-${index + 1} ${itemClass}`;
        aTag.innerHTML = `<img src="${imgSrc}" alt="작품">`;
        
        targetContainer.appendChild(aTag);
    });
}
        }
        
        // 프로필 관리 버튼 링크 연결
        const manageBtn = document.querySelector('.btn-profile-manage');
        if(manageBtn) {
            manageBtn.addEventListener('click', function() {
                location.href = '../../frontend/pages/myspace_setting.html'; // 관리 페이지 파일명
            });
        }
    });
</script>
</html>