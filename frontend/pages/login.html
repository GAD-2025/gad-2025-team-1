<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>로그인 - creAItive</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
    <style>
        /* 스타일은 기존과 동일하게 유지 */
        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Noto Sans KR', sans-serif; }
        body { background-color: #f5f5f5; display: flex; align-items: center; justify-content: center; min-height: 100vh; color: #333; }
        
        .login-container {
            background: white; width: 100%; max-width: 420px; padding: 40px; border-radius: 20px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        .login-header { text-align: center; margin-bottom: 40px; }
        .logo { font-size: 2.2rem; font-weight: 800; color: #FF5900; text-decoration: none; letter-spacing: -1px; }
        .login-desc { color: #888; margin-top: 10px; font-size: 0.95rem; }
        .form-group { margin-bottom: 20px; }
        .form-label { display: block; font-weight: bold; margin-bottom: 8px; font-size: 0.9rem; color: #555; }
        .form-input {
            width: 100%; padding: 14px 15px; border: 1px solid #ddd; border-radius: 8px; font-size: 1rem; transition: 0.2s;
        }
        .form-input:focus { border-color: #FF5900; outline: none; box-shadow: 0 0 0 3px rgba(255, 89, 0, 0.1); }
        .btn-login {
            width: 100%; padding: 15px; background-color: #FF5900; color: white; border: none; border-radius: 30px;
            font-size: 1.1rem; font-weight: bold; cursor: pointer; margin-top: 20px; transition: 0.3s;
        }
        .btn-login:hover { background-color: #e04e00; transform: translateY(-2px); }
        .error-msg { 
            color: #e74c3c; font-size: 0.9rem; text-align: center; margin-top: 15px; display: none;
            background: #fadbd8; padding: 10px; border-radius: 5px;
        }
        .bottom-links { display: flex; justify-content: space-between; margin-top: 25px; font-size: 0.9rem; color: #666; }
        .bottom-links a { color: #666; text-decoration: none; }
        .bottom-links a:hover { color: #FF5900; text-decoration: underline; }
        .signup-link-area { text-align: center; margin-top: 30px; padding-top: 20px; border-top: 1px solid #eee; font-size: 0.9rem; }
        .signup-link-area a { color: #FF5900; font-weight: bold; text-decoration: none; }
    </style>
</head>
<body>

    <div class="login-container">
        <div class="login-header">
            <a href="#" class="logo">creAItive</a>
            <p class="login-desc">다시 만나서 반가워요!</p>
        </div>

        <form id="loginForm">
            <div class="form-group">
                <label class="form-label">아이디</label>
                <input type="text" class="form-input" id="loginId" placeholder="아이디 입력" required>
            </div>

            <div class="form-group">
                <label class="form-label">비밀번호</label>
                <input type="password" class="form-input" id="loginPw" placeholder="비밀번호 입력" required>
            </div>

            <div class="error-msg" id="loginError"></div>

            <button type="submit" class="btn-login">로그인</button>
        </form>

        <div class="bottom-links">
            <a href="#">아이디 찾기</a>
            <a href="#">비밀번호 찾기</a>
        </div>

        <div class="signup-link-area">
            아직 회원이 아니신가요? <a href="signup.html">회원가입 하기</a>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        $(document).ready(function() {
            
            // 폼 제출(로그인 버튼 클릭) 시 실행
            $('#loginForm').on('submit', async function(e) {
                e.preventDefault(); // 화면 새로고침 방지

                const inputId = $('#loginId').val();
                const inputPw = $('#loginPw').val();

                try {
                    // 1. 서버(Node.js)에게 로그인 요청 보내기
                    const response = await fetch('http://localhost:3000/api/login', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ id: inputId, password: inputPw })
                    });

                    const result = await response.json();

                    // 2. 서버 응답 처리
                    if (result.success) {
                        // 성공 시: 로그인한 유저 정보를 브라우저 임시 저장소(SessionStorage)에 저장
                        // (myspace.html에서 이 정보를 꺼내서 이름을 표시할 예정)
                        sessionStorage.setItem('currentUser', JSON.stringify(result.user));
                        
                        alert(`${result.user.nickname}님 환영합니다!`);
                        location.href = 'myspace.html'; // 메인으로 이동
                    } else {
                        // 실패 시: 에러 메시지 표시
                        $('#loginError')
                            .html('<i class="fas fa-exclamation-circle"></i> ' + result.message)
                            .slideDown();
                    }
                } catch (err) {
                    console.error(err);
                    alert('서버와 연결할 수 없습니다. 서버가 켜져있는지 확인해주세요.');
                }
            });

            // 입력창 누르면 에러 메시지 끄기
            $('.form-input').on('focus', function() {
                $('#loginError').slideUp();
            });
        });
    </script>
</body>
</html>